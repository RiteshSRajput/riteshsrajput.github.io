var __awaiter=this&&this.__awaiter||function(e,t,r,i){function n(e){return e instanceof r?e:new r((function(t){t(e)}))}return new(r||(r=Promise))((function(r,s){function o(e){try{l(i.next(e))}catch(t){s(t)}}function a(e){try{l(i["throw"](e))}catch(t){s(t)}}function l(e){e.done?r(e.value):n(e.value).then(o,a)}l((i=i.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var r={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,n,s,o;return o={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(o[Symbol.iterator]=function(){return this}),o;function a(e){return function(t){return l([e,t])}}function l(o){if(i)throw new TypeError("Generator is already executing.");while(r)try{if(i=1,n&&(s=o[0]&2?n["return"]:o[0]?n["throw"]||((s=n["return"])&&s.call(n),0):n.next)&&!(s=s.call(n,o[1])).done)return s;if(n=0,s)o=[o[0]&2,s.value];switch(o[0]){case 0:case 1:s=o;break;case 4:r.label++;return{value:o[1],done:false};case 5:r.label++;n=o[1];o=[0];continue;case 7:o=r.ops.pop();r.trys.pop();continue;default:if(!(s=r.trys,s=s.length>0&&s[s.length-1])&&(o[0]===6||o[0]===2)){r=0;continue}if(o[0]===3&&(!s||o[1]>s[0]&&o[1]<s[3])){r.label=o[1];break}if(o[0]===6&&r.label<s[1]){r.label=s[1];s=o;break}if(s&&r.label<s[2]){r.label=s[2];r.ops.push(o);break}if(s[2])r.ops.pop();r.trys.pop();continue}o=t.call(e,r)}catch(a){o=[6,a];n=0}finally{i=s=0}if(o[0]&5)throw o[1];return{value:o[0]?o[1]:void 0,done:true}}};System.register(["./p-f4cc861d.system.js","./p-4b0c1219.system.js","./p-9f63c7d9.system.js"],(function(e){"use strict";var t,r,i,n,s,o;return{setters:[function(e){t=e.r;r=e.d;i=e.h;n=e.g},function(e){s=e.B},function(e){o=e.m}],execute:function(){var a="dxp-faceted-filter-item";var l=".filter-label";var c=e("dxp_faceted_filter",function(){function e(e){t(this,e);this.childElementCount=0;this.apiEndpoint="";this.closeWindow="";this.filterItemsJson=[];this.filterJson=[];this.heading="";this.isHeaderRequired=true;this.isSubCategory=""}e.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,(function(){var e,t;return __generator(this,(function(i){switch(i.label){case 0:this.base=new s(this,r);this.base.i18Init(r,"FacetedFilter",o);e=this;if(!this.apiEndpoint)return[3,2];return[4,r.api(this.apiEndpoint)];case 1:t=i.sent();return[3,3];case 2:t=this.filterJson;i.label=3;case 3:e.filterItemsJson=t;this.createFilterItemsObject();return[2]}}))}))};e.prototype.componentDidLoad=function(){if(this.heading){this.base.shadowRootQuerySelector(this.element,".dxp-text-eyebrow").innerHTML=this.heading+"&lrm;"}var e=this.base.shadowRootQuerySelector(this.element,a,true)&&this.base.shadowRootQuerySelector(this.element,a,true).length;var t=e?this.base.shadowRootQuerySelector(this.element,a,true):this.base.shadowRootQuerySelector(this.element,a,false);var r=t[t.length-1];this.base.shadowRootQuerySelector(r,l).classList.add("filter-bottom");if(t&&t.length>0){this.childElementCount=t.length}};e.prototype.expandCollapse=function(e){var t=this.getElementsByClass(l);var r=Array.prototype.slice.call(t);var i;var n;var s;var o=[32,38,40];var a=e.keyCode;n=e.target?e.target.activeElement:e.target;if(o.indexOf(e.keyCode)>-1){e.preventDefault()}if(a===9){n.classList.remove("no-outline")}i=this.getElementsByClass(".filter-content");s=this.getElementsByClass(l);if(n.classList.contains("expand-all")&&(a===32||a===13)){for(var c=0;c<s.length;c++){s[c].classList.add("active");i[c].classList.remove("dxp-none");i[c].style.maxHeight=""+i[c].scrollHeight+i[c].offsetHeight+"px"}}if(n.classList.contains("collapse-all")&&(a===32||a===13)){for(var c=0;c<r.length;c++){r[c].classList.remove("active");if(i[c]){i[c].removeAttribute("style");s[c].classList.remove("active");i[c].classList.add("dxp-none")}}}};e.prototype.routingHandler=function(e){this.base.routingEventListener(e)};e.prototype.createCategoryMarkup=function(e,t){var r=this;var i="";Object.keys(e).forEach((function(n){if(n==="type"){r.filterType=e[n]}else{if(t){i+=r.createNestedFilter(n,e[n],r.filterType).outerHTML}else{if(r.filterType==="checkbox"){i+=r.populateCheckboxFilter(e[n])}else if(r.filterType==="select"){i+=r.populateSelectFilter(e[n]).outerHTML}}}}));return i};e.prototype.createFilterItemsObject=function(){var e=this;this.filterItems=[];var t="";this.filterItemsJson.map((function(r){Object.keys(r).forEach((function(i){t="";if(r.hasOwnProperty("type")){if(i!=="type"){t=e.createCategoryMarkup(r,false)}}else{t=e.createSubCategoryMarkup(r)}if(i!=="type"){var n={title:i.toUpperCase(),description:t,isSubCategory:"false"};e.filterItems.push(n)}}))}))};e.prototype.createNestedFilter=function(e,t,r){var i;i=document.createElement(a);i.setAttribute("item-title",e);i.setAttribute("is-sub-category","true");if(r==="checkbox"){i.setAttribute("item-description",this.populateCheckboxFilter(t))}else if(r==="select"){i.setAttribute("item-description",this.populateSelectFilter(t).outerHTML)}return i};e.prototype.createSubCategoryMarkup=function(e){var t=this;var r="";Object.keys(e).forEach((function(i){e[i].map((function(e){r+=t.createCategoryMarkup(e,true)}))}));return r};e.prototype.getElementsByClass=function(e){var t=this;var r=new Array;var i=this.base.shadowRootQuerySelector(this.element,"slot");if(i){i.assignedNodes().filter((function(i){if(i.nodeName!=="#text"){var n=i.QuerySelector(t.element,e);r.push(n)}}))}else{var n=this.base.shadowRootQuerySelector(this.element,a);if(n&&n.length>0){for(var s=0,o=n;s<o.length;s++){var l=o[s];r.push(l.QuerySelector(this.element,e))}}}return r};e.prototype.populateCheckboxFilter=function(e){var t="";if(e&&e.length>0){e.map((function(e){var r;r=document.createElement("dxp-checkbox");r.setAttribute("name",e);r.setAttribute("value",e);t+=r.outerHTML;t+="<br>"}))}return t};e.prototype.populateSelectFilter=function(e){var t;t=document.createElement("select");e.map((function(e){var r=document.createElement("option");r.setAttribute("value",e);var i=document.createTextNode(e);r.appendChild(i);t.appendChild(r)}));return t};e.prototype.render=function(){var e=this;r.log.debug("in dxp-faceted-filter render() : "+"DEVELOPMENT");var t=[i("link",{rel:"stylesheet",href:""}),[this.theme&&i("link",{rel:"stylesheet",href:""})],[this.theme&&i("link",{rel:"stylesheet",href:r.config.get("DXP_STYLE_BASE_URL")+"/themes/"+this.theme+"/dxp-faceted-filter.min.css"})]];return i("div",{class:this.base.componentClass(),dir:this.dir,"data-theme":this.theme},i("div",{class:"dxp-faceted-filter-container"},t,i("div",{class:"toggle"},i("div",{class:"dxp-row"},this.isHeaderRequired&&i("div",{class:"dxp-col-12 dxp-faceted-filter-header"},i("p",null,i("span",{class:"dxp-text-eyebrow dxp-col-sm-6 dxp-col-12 dxp-filter-align"}),i("a",{href:"javaScript:void(0)"},i("span",{class:"dxp-col-sm-6 dxp-col-12 dxp-text-right text-margin filter-clear dxp-closewindow-align"},this.closeWindow,i("span",{class:"dxp-icon dxp-icon-x-small dxp-icon-close dxp-close-text"})))))),this.filterItems?this.filterItems.map((function(e){return i("dxp-faceted-filter-item",{"item-title":e.title,"item-subtitle":e.subtitle,"item-description":e.description,"show-expanded":e.showExpanded,"is-sub-category":e.isSubCategory})})):i("div",{ref:function(t){return e.filterItemContainer=t}},i("slot",null)))))};Object.defineProperty(e.prototype,"element",{get:function(){return n(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return"div.dxp.dxp-faceted-filter .dxp-faceted-filter-item{display:block;width:100%}div.dxp.dxp-faceted-filter .dxp-faceted-filter-container{width:19%}div.dxp.dxp-faceted-filter .dxp-faceted-filter-header{position:relative;top:10px}div.dxp.dxp-faceted-filter .text-margin{margin-top:5px}div.dxp.dxp-faceted-filter .dxp-close-filter{padding-bottom:5px}div.dxp.dxp-faceted-filter .dxp-close-text{padding-left:10px}div.dxp.dxp-faceted-filter .dxp-filter-align{padding-left:0;font-size:1.05rem}div.dxp.dxp-faceted-filter .toggle .title-wrapper{padding-bottom:1.5rem;margin-bottom:2rem;display:-ms-flexbox;display:flex;-ms-flex-wrap:wrap;flex-wrap:wrap}div.dxp.dxp-faceted-filter .toggle .title-wrapper>span{padding:0}div.dxp.dxp-faceted-filter .toggle .title-wrapper>span:last-child{text-align:right}div.dxp.dxp-faceted-filter .toggle .title-wrapper>span:only-child{text-align:left}div.dxp.dxp-faceted-filter .toggle .expand-all{cursor:pointer}div.dxp.dxp-faceted-filter .toggle .collapse-all{cursor:pointer;margin-left:.5625rem}div.dxp.dxp-faceted-filter .pipe-separator:after{content:\"|\";padding-left:.75rem}\@media (max-width:1024px){div.dxp.dxp-faceted-filter .dxp-faceted-filter-container{width:25%}}\@media (max-width:575px){div.dxp.dxp-faceted-filter .dxp-faceted-filter-container{width:100%}div.dxp.dxp-faceted-filter .dxp-filter-align{position:relative;top:22px}div.dxp.dxp-faceted-filter .dxp-closewindow-align{position:relative;bottom:15px}div.dxp.dxp-faceted-filter .toggle .title-wrapper{border:none;margin-bottom:1rem}div.dxp.dxp-faceted-filter .toggle .title-wrapper>span:first-child{padding-bottom:2rem}}div.dxp.dxp-faceted-filter[dir=rtl] .toggle .title-wrapper>span:last-child{text-align:left}div.dxp.dxp-faceted-filter[dir=rtl] .toggle .title-wrapper>span:only-child{text-align:right}"},enumerable:true,configurable:true});return e}())}}}));