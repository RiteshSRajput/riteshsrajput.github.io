var __awaiter=this&&this.__awaiter||function(e,t,n,a){function r(e){return e instanceof n?e:new n((function(t){t(e)}))}return new(n||(n=Promise))((function(n,i){function s(e){try{l(a.next(e))}catch(t){i(t)}}function o(e){try{l(a["throw"](e))}catch(t){i(t)}}function l(e){e.done?n(e.value):r(e.value).then(s,o)}l((a=a.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var n={label:0,sent:function(){if(i[0]&1)throw i[1];return i[1]},trys:[],ops:[]},a,r,i,s;return s={next:o(0),throw:o(1),return:o(2)},typeof Symbol==="function"&&(s[Symbol.iterator]=function(){return this}),s;function o(e){return function(t){return l([e,t])}}function l(s){if(a)throw new TypeError("Generator is already executing.");while(n)try{if(a=1,r&&(i=s[0]&2?r["return"]:s[0]?r["throw"]||((i=r["return"])&&i.call(r),0):r.next)&&!(i=i.call(r,s[1])).done)return i;if(r=0,i)s=[s[0]&2,i.value];switch(s[0]){case 0:case 1:i=s;break;case 4:n.label++;return{value:s[1],done:false};case 5:n.label++;r=s[1];s=[0];continue;case 7:s=n.ops.pop();n.trys.pop();continue;default:if(!(i=n.trys,i=i.length>0&&i[i.length-1])&&(s[0]===6||s[0]===2)){n=0;continue}if(s[0]===3&&(!i||s[1]>i[0]&&s[1]<i[3])){n.label=s[1];break}if(s[0]===6&&n.label<i[1]){n.label=i[1];i=s;break}if(i&&n.label<i[2]){n.label=i[2];n.ops.push(s);break}if(i[2])n.ops.pop();n.trys.pop();continue}s=t.call(e,n)}catch(o){s=[6,o];r=0}finally{a=i=0}if(s[0]&5)throw s[1];return{value:s[0]?s[1]:void 0,done:true}}};System.register(["./p-f4cc861d.system.js","./p-4b0c1219.system.js"],(function(e){"use strict";var t,n,a,r,i;return{setters:[function(e){t=e.r;n=e.d;a=e.h;r=e.g},function(e){i=e.B}],execute:function(){var s="dxp-language-selector";var o="selected-language";var l="show-lang-list";var u=e("dxp_language_selector",function(){function e(e){t(this,e);this.cCode="";this.showLanguage=false}e.prototype.languageHandler=function(){if(this.languageLocales&&this.apiUrl){this.languageLocales=this.sortByLanguageName(this.languageLocales)}this.base.createNestedMarkup(this.languageContainer,"dxp-language-item",this.languageLocales);if(this.languageLocales&&this.languageContainer){this.parentChildLen=this.languageContainer.children.length;for(var e=0,t=Object.keys(this.languageContainer.children);e<t.length;e++){var n=t[e];if(this.locale){var a=this.languageLocales[n].locale.toLowerCase().replace("_","-")===this.locale.replace("_","-")?"true":"false";this.languageContainer.children[n].setAttribute(o,a)}else{this.languageContainer.children[n].setAttribute(o,n==="0"?"true":"false")}}}};e.prototype.componentWillLoad=function(){return __awaiter(this,void 0,void 0,(function(){var e,t,a;return __generator(this,(function(r){switch(r.label){case 0:this.base=new i(this,n);this.base.i18Init(n,"LanguageSelector","");this.isLanguageItemPresent=this.base.returnBooleanValue(this.element.querySelector("dxp-language-item"));e=this.element?this.element:this.element;t="";n.util.appendLinkElement(e,t);t="";n.util.appendLinkElement(e,t);t=n.config.get("DXP_STYLE_BASE_URL")+"/themes/"+this.theme+"/dxp-language-selector.min.css";n.util.appendLinkElement(e,t);this.parentChildLen=document.querySelector(s)?document.querySelector(s).children.length:0;this.count=0;if(!this.apiUrl)return[3,2];a=this;return[4,this.fetchAPI()];case 1:a.languageData=r.sent();this.fetchLocales(this.languageData);r.label=2;case 2:return[2]}}))}))};e.prototype.componentDidLoad=function(){var e=this;document.addEventListener("mouseenter",(function(t){var n=t.target;if(n.nodeName!=="#document"&&n.nodeName==="A"&&!n.closest(s)){e.showLanguage=false}}),true);this.languageHandler()};e.prototype.clickEvent=function(e){if(e.target&&e.composedPath()[0]){this.showLanguage=e.composedPath()[0].className===l||e.composedPath()[0].classList.contains("sel-lang")?this.showLanguage:false}else if(e.target.classList.contains("sc-dxp-language-selector")){this.showLanguage=this.showLanguage}else{this.showLanguage=false}this.count=0};e.prototype.handleKeyDown=function(e){if(e.keyCode===9){this.count=0;this.showLanguage=false}if(e.keyCode===32){e.preventDefault()}};e.prototype.handleKeyUp=function(e){var t=e.keyCode;var n=e.target?e.composedPath()[0]:e.target;if((e.target.localName===s||e.target.localName==="li"||e.target.parentElement.classList.contains(l)||e.target.classList.contains(l))&&(t===13||t===32)){if(n.classList.contains("langElement")){n.parentElement.parentElement.handleChange()}else{this.count=0}this.showLanguage=!this.showLanguage}if(t===40&&this.count<this.parentChildLen){this.accessibilityFocus(e,this.count,"down");this.count++}if(t===38){this.count--;if(this.count>0){this.accessibilityFocus(e,this.count-1,"up")}else{this.count=1}}if(t===27){this.count=0;this.showLanguage=false}if(t===9){this.count=0;this.showLanguage=false}};e.prototype.languageChangedHandler=function(e){this.showLanguage=!this.showLanguage;for(var t=0,a=Object.keys(e.target.parentElement.children);t<a.length;t++){var r=a[t];e.target.parentElement.children[r].setAttribute(o,"false")}e.target.setAttribute(o,"true");n.log.debug(this.element.tagName,"languageChangeHandler()","Received the custom languageChanged event: ",Option)};e.prototype.routingHandler=function(e){this.base.routingEventListener(e)};e.prototype.accessibilityFocus=function(e,t,n){if(e.target.localName===s){var a=!this.languageLocales?e.target.children[t].querySelector("li"):e.target.children[2].getElementsByTagName("dxp-language-item")[t].querySelector("li");this.focusElement(a)}else if(e.target.parentElement.classList.contains(l)){var r=e.target.parentElement;var a=this.returnFocusItem(r,n,t);this.focusElement(a)}else if(e.target.classList.contains(l)){var r=e.target;var a=this.returnFocusItem(r,n,t);this.focusElement(a)}else{var i=e.target.parentElement.parentElement;var a=n==="down"?i.nextElementSibling.querySelector("li"):i.previousElementSibling.querySelector("li");this.focusElement(a)}};e.prototype.fetchAPI=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){switch(t.label){case 0:this.cCode=this.locale.substr(3);t.label=1;case 1:t.trys.push([1,3,,4]);return[4,n.api(this.apiUrl)];case 2:return[2,t.sent()];case 3:e=t.sent();n.log.error(this.element.tagName,"fetchAPI()","fetch failed for "+this.apiUrl,e);return[3,4];case 4:return[2]}}))}))};e.prototype.fetchLocales=function(e){if(e){for(var t=0,n=e.countries;t<n.length;t++){var a=n[t];if(a.countryCode.toUpperCase()===this.cCode.toUpperCase()){this.languageLocales=a.locales}}}};e.prototype.focusElement=function(e){e.focus()};e.prototype.returnFocusItem=function(e,t,n){var a=e.nextElementSibling.children[0];if(t==="down"){return a.children[n].querySelector("li")}return a.children[n-1].querySelector("li")};e.prototype.sortByLanguageName=function(e){if(e){return e.sort((function(e,t){var n=e.language.toUpperCase();var a=t.language.toUpperCase();if(n<a){return-1}if(n>a){return 1}return 0}))}};e.prototype.toggleShowLanguage=function(){this.showLanguage=!this.showLanguage};e.prototype.render=function(){var e=this;if(this.languageLocales&&this.languageLocales.length>0||this.isLanguageItemPresent){return a("div",{dir:this.dir,class:this.base.componentClass(),"data-theme":this.theme},a("div",{class:"language-selector"},a("div",{class:"language-wrapper "+(this.showLanguage?"active":""),role:"application"},a("span",{id:"language-selector",class:"show-lang-list",onClick:function(){return e.toggleShowLanguage()},"aria-haspopup":"listbox",role:"button","aria-label":"Language Selector Dropdown",tabindex:"0"},a("span",{class:"sel-lang lang-position lang-caret"})),a("ul",{class:"header-lang-list lang-list",role:"listbox","aria-label":"select language from list "},a("div",{ref:function(t){return e.languageContainer=t}},a("slot",null))))))}};Object.defineProperty(e.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(e,"watchers",{get:function(){return{languageLocales:["languageHandler"]}},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return"div.dxp.dxp-language-selector .language-wrapper{padding-right:0;width:50px;position:relative;cursor:pointer}div.dxp.dxp-language-selector .language-wrapper.active .header-lang-list{display:block}div.dxp.dxp-language-selector .show-lang-list{height:56px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}div.dxp.dxp-language-selector .sel-lang{height:25px;width:40px;padding-left:0;display:inline-block}div.dxp.dxp-language-selector ul{display:none;padding-top:12px;border-radius:0 0 4px 4px;position:absolute;top:56px;z-index:1;right:0}div.dxp.dxp-language-selector .lang-caret{position:relative}div.dxp.dxp-language-selector .lang-caret:after,div.dxp.dxp-language-selector .lang-caret:before{content:\"\";height:6px;width:1px;position:absolute;top:10px;display:block;-webkit-transform:rotate(45deg);transform:rotate(45deg);right:0;border-radius:3px}div.dxp.dxp-language-selector .lang-caret:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:4px}div.dxp.dxp-language-selector .lang-list:hover>li.active span{border:none;padding:12px 0}div.dxp.dxp-language-selector .lang-list:hover>li.active:hover span{padding-bottom:8px}div.dxp.dxp-language-selector .language-selector>div{padding-right:0}div.dxp.dxp-language-selector .language-selector>div:after{content:\".\";display:block;height:0;clear:both;visibility:hidden}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper{float:left}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper ul{left:0;right:auto}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper li{text-align:left}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .sel-lang{padding-right:32px}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret{position:relative}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:after,div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:before{content:\"\";height:6px;width:1px;position:absolute;top:10px;display:block;-webkit-transform:rotate(45deg);transform:rotate(45deg);right:32px;border-radius:3px}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:36px}"},enumerable:true,configurable:true});return e}())}}}));