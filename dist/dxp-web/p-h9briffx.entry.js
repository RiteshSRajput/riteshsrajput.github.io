import{r as t,c as s,d as i,h,g as e}from"./p-8188e849.js";import{B as a}from"./p-16d6f0ca.js";class r{constructor(){this.DEFAULT_CVC_LENGTH=3,this.DEFAULT_ZIP_LENGTH=5,this.DEFAULT_CARD_FORMAT=/(\d{1,4})/g,this.CARD_TYPES=[{type:"amex",format:/(\d{1,4})(\d{1,6})?(\d{1,5})?/,startPattern:/^3[47]/,maxCardNumberLength:17,cvcLength:4},{type:"dankort",format:this.DEFAULT_CARD_FORMAT,startPattern:/^5019/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"hipercard",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(384100|384140|384160|606282|637095|637568|60(?!11))/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"dinersclub",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(36|38|30[0-5])/,maxCardNumberLength:14,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"discover",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(6011|65|64[4-9]|622)/,maxCardNumberLength:16,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"jcb",format:this.DEFAULT_CARD_FORMAT,startPattern:/^35/,maxCardNumberLength:16,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"laser",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(6706|6771|6709)/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"maestro",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(5018|5020|5038|6304|6703|6708|6759|676[1-3])/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"mastercard",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(5[1-5]|677189)|^(222[1-9]|2[3-6]\d{2}|27[0-1]\d|2720)/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"unionpay",format:this.DEFAULT_CARD_FORMAT,startPattern:/^62/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH,luhn:!1},{type:"visaelectron",format:this.DEFAULT_CARD_FORMAT,startPattern:/^4(026|17500|405|508|844|91[37])/,maxCardNumberLength:16,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"elo",format:this.DEFAULT_CARD_FORMAT,startPattern:/^(4011(78|79)|43(1274|8935)|45(1416|7393|763(1|2))|50(4175|6699|67[0-7][0-9]|9000)|627780|63(6297|6368)|650(03([^4])|04([0-9])|05(0|1)|4(0[5-9]|3[0-9]|8[5-9]|9[0-9])|5([0-2][0-9]|3[0-8])|9([2-6][0-9]|7[0-8])|541|700|720|901)|651652|655000|655021)/,maxCardNumberLength:16,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"visa",format:this.DEFAULT_CARD_FORMAT,startPattern:/^4/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH},{type:"fake",format:this.DEFAULT_CARD_FORMAT,startPattern:/^[0-9]/,maxCardNumberLength:19,cvcLength:this.DEFAULT_CVC_LENGTH}]}getCardTypeByValue(t){return this.CARD_TYPES.filter(s=>s.startPattern.test(t))[0]}formatCardNumber(t){const s=this.getCardTypeByValue(t);if(!s)return!1;const{format:i}=s;if(i.global)return{value:t.match(i).join(" "),cardType:s};const h=i.exec(t.split(" ").join(""));return h?{value:h.splice(1,3).filter(t=>t).join(" "),cardType:s}:t}}const n=class{constructor(i){t(this,i),this.cardInfo=[],this.isListenerAttached=!1,this.isPassword=!1,this.isTypeCard=!1,this.isValid=!0,this.isValidate=!1,this.autoFocus=!1,this.disabled=!1,this.enableAutocomplete="off",this.isOptional=!1,this.isRequired=!1,this.max="",this.maxLength=100,this.min="",this.minLength=0,this.readonly=!1,this.step="",this.type="text",this.validationMessage="",this.value="",this.width="",this.textValue=s(this,"textValue",7)}componentWillLoad(){this.base=new a(this,i),document.addEventListener("invalid",t=>{t.preventDefault()},!0),this.isPassword="password"===this.type,"card"===this.type&&(this.type="text",this.isTypeCard=!0)}handleBlur(t){this.isValidate||"Tab"!==t.key&&(this.isValidate=!0,this.isValid=!0)}routingHandler(t){this.base.routingEventListener(t)}async handleChange(t){if(this.isValidate)if(this.textValue.emit({value:t.target.value}),this.value=t.target.value,this.isTypeCard){this.handleCard(t);const s=[];""!==this.value&&s.push(this.isValid),s.push(this.isRequiredProvided(this.value)),this.isValid=s.every(t=>t)}else this.isValid=this.isValidInput(this.value)}async updateValidationState(t){this.isValid=t}handleCard(t){if(isNaN(Number(t.target.value.split(" ").join(""))))this.value=0!==this.value.length?this.value.substring(0,this.value.length-1):"";else{const s=(new r).formatCardNumber(t.target.value);!1!==s?(this.value=s.value,this.cardType=s.cardType.type,this.maxLength=s.cardType.maxCardNumberLength,this.value.length===this.maxLength?(this.isValid=!0,"fake"===this.cardType&&(this.isValid=!1)):this.isValid=!1):(this.isValid=s,this.cardType="",this.maxLength=16)}}isRequiredProvided(t){return!0===this.isOptional||""!==t}isValidCardInput(t){if(this.isTypeCard)return 19!==this.value.length?(3!==this.cardInfo.length?this.cardInfo.push(t):(this.value=`${this.value}-`,this.cardInfo=[]),!1):(this.textValue.emit({value:this.value.replace(/-/g,"")}),!0)}isValidInput(t){return"email"===this.type&&void 0===this.pattern&&(this.pattern=new RegExp(/^(([^<>()\[\]\\.,;:\s@"]+(\.[^<>()\[\]\\.,;:\s@"]+)*)|(".+"))@((\[[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\.[0-9]{1,3}\])|(([a-zA-Z\-0-9]+\.)+[a-zA-Z]{2,}))$/)),"url"===this.type&&!1===this.isOptional?this.isValidUrlPattern(t):"password"===this.type?this.isValidPassword(t):"number"===this.type?this.isValidNumber(t):!(0!==this.minLength&&!this.isValidMinLength(t))&&(void 0!==this.pattern?this.isValidPattern(t):this.isRequiredProvided(t))}isValidMinLength(t){return""!==t&&t.length>this.minLength}isValidNumber(t){const s=[];return s.push(this.isRequiredProvided(t)),""===t&&(t=0),""!==this.min&&s.push(parseInt(this.min,10)<=parseInt(t,10)),""!==this.max&&s.push(parseInt(this.max,10)>=parseInt(t,10)),s.push(this.isValidPattern(t)),s.every(t=>t)}isValidPassword(t){return!!this.isRequiredProvided(t)&&t.length>=this.minLength&&this.isValidPattern(t)}isValidPattern(t){return this.pattern=new RegExp(this.pattern),!(""!==t&&!this.pattern.test(t))&&this.isRequiredProvided(t)}isValidUrlPattern(t){if(void 0===this.pattern){const s=new RegExp("^(http://www.|https://www.|http://|https://)?[a-z0-9]+([-.]{1}[a-z0-9]+)*.[a-z]{2,5}(:[0-9]{1,5})?(/.*)?$");return""!==t&&s.test(t)}return this.isValidPattern(t)}togglePasswordIcon(t){this.type="text",t.target.classList.contains("view-pass-icon")?(t.target.classList.remove("view-pass-icon"),t.target.classList.add("hide-pass-icon")):(t.target.classList.remove("hide-pass-icon"),t.target.classList.add("view-pass-icon"))}render(){this.validationMessage=""===this.validationMessage?"Please enter a valid "+(this.label?this.label:"field"):this.validationMessage;const t=[h("link",{rel:"stylesheet",href:""}),[this.theme&&h("link",{rel:"stylesheet",href:""})],[this.theme&&h("link",{rel:"stylesheet",href:`${i.config.get("DXP_STYLE_BASE_URL")}/themes/${this.theme}/dxp-input.min.css`})]];return h("div",{class:this.base.componentClass(),"data-theme":this.theme},t,h("label",{class:this.disabled?"dxp-disabled dxp-inputbox-label":this.isValid?"dxp-inputbox-label":"dxp-inputbox-label dxp-error",htmlFor:this.label},this.label,this.isOptional?h("span",{class:"dxp-optional"}," (Optional)"):""),h("div",{class:"input-container"},h("input",{class:this.isValid?"":"has-error",type:this.type,id:this.contentId,name:this.name,spellcheck:this.spellcheckRequired,"aria-invalid":!this.isValid,"aria-required":this.isOptional?"":"true","aria-label":this.accessibilityText,placeholder:this.placeholder,value:this.value,minlength:this.minLength,maxlength:this.maxLength,autocomplete:this.enableAutocomplete,onInput:t=>this.handleChange(t),autoComplete:this.enableAutocomplete,readonly:this.readonly,disabled:this.disabled,autofocus:this.autoFocus,height:this.height,width:this.width,min:this.min,max:this.max,step:this.step,pattern:this.pattern}),!this.isValid&&h("span",{class:"input-icon icon-sprite error-circle-red"}),this.isTypeCard?h("span",{class:"icon-inputs "+this.cardType}):"",this.isPassword?h("span",{class:"icon-inputs view-pass-icon",onClick:t=>this.togglePasswordIcon(t)}):""),this.isValid?"":h("div",{class:"dxp-error",id:"errMsg","aria-label":this.validationMessage},this.validationMessage))}get element(){return e(this)}static get style(){return"div.dxp.dxp-input .input-container{position:relative;width:100%}div.dxp.dxp-input .dxp-inputbox-label{font-size:12px;margin-bottom:.25rem}div.dxp.dxp-input .input-icon{position:absolute;right:.5rem;top:.75rem}div.dxp.dxp-input .icon-inputs{background:transparent url(process.env.DXP_COMPONENT_ASSET_PATH/dxp-input/card-icons-sprite.svg) no-repeat;background-size:650%;background-position-y:5px;display:none;position:absolute;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%);right:5px;width:30px;height:30px}div.dxp.dxp-input.amex,div.dxp.dxp-input.discover,div.dxp.dxp-input.hide-pass-icon,div.dxp.dxp-input.jcp,div.dxp.dxp-input.unionpay,div.dxp.dxp-input.view-pass-icon,div.dxp.dxp-input.visa{display:block}div.dxp.dxp-input .mastercard{background-position-x:0}div.dxp.dxp-input .visa{background-position-x:-32px}div.dxp.dxp-input .amex{background-position-x:-100px}div.dxp.dxp-input .unionpay{background-position-x:-65px}div.dxp.dxp-input .discover{background-position-x:-165px}div.dxp.dxp-input .jcb{background-position-x:-132px}div.dxp.dxp-input .hide-pass-icon{background:transparent url(process.env.DXP_COMPONENT_ASSET_PATH/dxp-input/hide-pass.svg) 2px 9px no-repeat}div.dxp.dxp-input .view-pass-icon{background:transparent url(process.env.DXP_COMPONENT_ASSET_PATH/dxp-input/show-pass.svg) 2px 9px no-repeat}div.dxp.dxp-input [dir=rtl] .hide-pass-mask,div.dxp.dxp-input [dir=rtl] .view-pass-mask{right:auto;left:5px}div.dxp.dxp-input .input-box{display:block;width:100%;height:2.5rem;padding:.625rem 3.25rem .625rem 1rem;font-size:.875rem;line-height:1.25rem}div.dxp.dxp-input .input-box::-ms-clear{display:none}"}};export{n as dxp_input};