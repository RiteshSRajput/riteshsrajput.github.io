import{r as t,d as s,h as e,g as i}from"./p-8188e849.js";import{B as a}from"./p-16d6f0ca.js";const l=class{constructor(s){t(this,s),this.cCode="",this.showLanguage=!1}languageHandler(){if(this.languageLocales&&this.apiUrl&&(this.languageLocales=this.sortByLanguageName(this.languageLocales)),this.base.createNestedMarkup(this.languageContainer,"dxp-language-item",this.languageLocales),this.languageLocales&&this.languageContainer){this.parentChildLen=this.languageContainer.children.length;for(const t of Object.keys(this.languageContainer.children))if(this.locale){const s=this.languageLocales[t].locale.toLowerCase().replace("_","-")===this.locale.replace("_","-")?"true":"false";this.languageContainer.children[t].setAttribute("selected-language",s)}else this.languageContainer.children[t].setAttribute("selected-language","0"===t?"true":"false")}}async componentWillLoad(){this.base=new a(this,s),this.base.i18Init(s,"LanguageSelector",""),this.isLanguageItemPresent=this.base.returnBooleanValue(this.element.querySelector("dxp-language-item"));const t=this.element;let e="";s.util.appendLinkElement(t,e),s.util.appendLinkElement(t,e=""),e=`${s.config.get("DXP_STYLE_BASE_URL")}/themes/${this.theme}/dxp-language-selector.min.css`,s.util.appendLinkElement(t,e),this.parentChildLen=document.querySelector("dxp-language-selector")?document.querySelector("dxp-language-selector").children.length:0,this.count=0,this.apiUrl&&(this.languageData=await this.fetchAPI(),this.fetchLocales(this.languageData))}componentDidLoad(){document.addEventListener("mouseenter",t=>{const s=t.target;"#document"===s.nodeName||"A"!==s.nodeName||s.closest("dxp-language-selector")||(this.showLanguage=!1)},!0),this.languageHandler()}clickEvent(t){this.showLanguage=t.target&&t.composedPath()[0]?!("show-lang-list"!==t.composedPath()[0].className&&!t.composedPath()[0].classList.contains("sel-lang"))&&this.showLanguage:!!t.target.classList.contains("sc-dxp-language-selector")&&this.showLanguage,this.count=0}handleKeyDown(t){9===t.keyCode&&(this.count=0,this.showLanguage=!1),32===t.keyCode&&t.preventDefault()}handleKeyUp(t){const s=t.keyCode,e=t.target?t.composedPath()[0]:t.target;"dxp-language-selector"!==t.target.localName&&"li"!==t.target.localName&&!t.target.parentElement.classList.contains("show-lang-list")&&!t.target.classList.contains("show-lang-list")||13!==s&&32!==s||(e.classList.contains("langElement")?e.parentElement.parentElement.handleChange():this.count=0,this.showLanguage=!this.showLanguage),40===s&&this.count<this.parentChildLen&&(this.accessibilityFocus(t,this.count,"down"),this.count++),38===s&&(this.count--,this.count>0?this.accessibilityFocus(t,this.count-1,"up"):this.count=1),27===s&&(this.count=0,this.showLanguage=!1),9===s&&(this.count=0,this.showLanguage=!1)}languageChangedHandler(t){this.showLanguage=!this.showLanguage;for(const s of Object.keys(t.target.parentElement.children))t.target.parentElement.children[s].setAttribute("selected-language","false");t.target.setAttribute("selected-language","true"),s.log.debug(this.element.tagName,"languageChangeHandler()","Received the custom languageChanged event: ",Option)}routingHandler(t){this.base.routingEventListener(t)}accessibilityFocus(t,s,e){if("dxp-language-selector"===t.target.localName){const e=this.languageLocales?t.target.children[2].getElementsByTagName("dxp-language-item")[s].querySelector("li"):t.target.children[s].querySelector("li");this.focusElement(e)}else if(t.target.parentElement.classList.contains("show-lang-list")){const i=this.returnFocusItem(t.target.parentElement,e,s);this.focusElement(i)}else if(t.target.classList.contains("show-lang-list")){const i=this.returnFocusItem(t.target,e,s);this.focusElement(i)}else{const s=t.target.parentElement.parentElement,i="down"===e?s.nextElementSibling.querySelector("li"):s.previousElementSibling.querySelector("li");this.focusElement(i)}}async fetchAPI(){this.cCode=this.locale.substr(3);try{return await s.api(this.apiUrl)}catch(t){s.log.error(this.element.tagName,"fetchAPI()",`fetch failed for ${this.apiUrl}`,t)}}fetchLocales(t){if(t)for(const s of t.countries)s.countryCode.toUpperCase()===this.cCode.toUpperCase()&&(this.languageLocales=s.locales)}focusElement(t){t.focus()}returnFocusItem(t,s,e){const i=t.nextElementSibling.children[0];return"down"===s?i.children[e].querySelector("li"):i.children[e-1].querySelector("li")}sortByLanguageName(t){if(t)return t.sort((t,s)=>{const e=t.language.toUpperCase(),i=s.language.toUpperCase();return e<i?-1:e>i?1:0})}toggleShowLanguage(){this.showLanguage=!this.showLanguage}render(){if(this.languageLocales&&this.languageLocales.length>0||this.isLanguageItemPresent)return e("div",{dir:this.dir,class:this.base.componentClass(),"data-theme":this.theme},e("div",{class:"language-selector"},e("div",{class:`language-wrapper ${this.showLanguage?"active":""}`,role:"application"},e("span",{id:"language-selector",class:"show-lang-list",onClick:()=>this.toggleShowLanguage(),"aria-haspopup":"listbox",role:"button","aria-label":"Language Selector Dropdown",tabindex:"0"},e("span",{class:"sel-lang lang-position lang-caret"})),e("ul",{class:"header-lang-list lang-list",role:"listbox","aria-label":"select language from list "},e("div",{ref:t=>this.languageContainer=t},e("slot",null))))))}get element(){return i(this)}static get watchers(){return{languageLocales:["languageHandler"]}}static get style(){return"div.dxp.dxp-language-selector .language-wrapper{padding-right:0;width:50px;position:relative;cursor:pointer}div.dxp.dxp-language-selector .language-wrapper.active .header-lang-list{display:block}div.dxp.dxp-language-selector .show-lang-list{height:56px;display:-ms-flexbox;display:flex;-ms-flex-align:center;align-items:center}div.dxp.dxp-language-selector .sel-lang{height:25px;width:40px;padding-left:0;display:inline-block}div.dxp.dxp-language-selector ul{display:none;padding-top:12px;border-radius:0 0 4px 4px;position:absolute;top:56px;z-index:1;right:0}div.dxp.dxp-language-selector .lang-caret{position:relative}div.dxp.dxp-language-selector .lang-caret:after,div.dxp.dxp-language-selector .lang-caret:before{content:\"\";height:6px;width:1px;position:absolute;top:10px;display:block;-webkit-transform:rotate(45deg);transform:rotate(45deg);right:0;border-radius:3px}div.dxp.dxp-language-selector .lang-caret:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:4px}div.dxp.dxp-language-selector .lang-list:hover>li.active span{border:none;padding:12px 0}div.dxp.dxp-language-selector .lang-list:hover>li.active:hover span{padding-bottom:8px}div.dxp.dxp-language-selector .language-selector>div{padding-right:0}div.dxp.dxp-language-selector .language-selector>div:after{content:\".\";display:block;height:0;clear:both;visibility:hidden}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper{float:left}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper ul{left:0;right:auto}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper li{text-align:left}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .sel-lang{padding-right:32px}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret{position:relative}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:after,div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:before{content:\"\";height:6px;width:1px;position:absolute;top:10px;display:block;-webkit-transform:rotate(45deg);transform:rotate(45deg);right:32px;border-radius:3px}div.dxp.dxp-language-selector[dir=rtl] .language-wrapper .lang-caret:after{-webkit-transform:rotate(-45deg);transform:rotate(-45deg);right:36px}"}};export{l as dxp_language_selector};