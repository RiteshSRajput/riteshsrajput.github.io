var __awaiter=this&&this.__awaiter||function(e,t,i,o){function s(e){return e instanceof i?e:new i((function(t){t(e)}))}return new(i||(i=Promise))((function(i,r){function n(e){try{l(o.next(e))}catch(t){r(t)}}function a(e){try{l(o["throw"](e))}catch(t){r(t)}}function l(e){e.done?i(e.value):s(e.value).then(n,a)}l((o=o.apply(e,t||[])).next())}))};var __generator=this&&this.__generator||function(e,t){var i={label:0,sent:function(){if(r[0]&1)throw r[1];return r[1]},trys:[],ops:[]},o,s,r,n;return n={next:a(0),throw:a(1),return:a(2)},typeof Symbol==="function"&&(n[Symbol.iterator]=function(){return this}),n;function a(e){return function(t){return l([e,t])}}function l(n){if(o)throw new TypeError("Generator is already executing.");while(i)try{if(o=1,s&&(r=n[0]&2?s["return"]:n[0]?s["throw"]||((r=s["return"])&&r.call(s),0):s.next)&&!(r=r.call(s,n[1])).done)return r;if(s=0,r)n=[n[0]&2,r.value];switch(n[0]){case 0:case 1:r=n;break;case 4:i.label++;return{value:n[1],done:false};case 5:i.label++;s=n[1];n=[0];continue;case 7:n=i.ops.pop();i.trys.pop();continue;default:if(!(r=i.trys,r=r.length>0&&r[r.length-1])&&(n[0]===6||n[0]===2)){i=0;continue}if(n[0]===3&&(!r||n[1]>r[0]&&n[1]<r[3])){i.label=n[1];break}if(n[0]===6&&i.label<r[1]){i.label=r[1];r=n;break}if(r&&i.label<r[2]){i.label=r[2];i.ops.push(n);break}if(r[2])i.ops.pop();i.trys.pop();continue}n=t.call(e,i)}catch(a){n=[6,a];s=0}finally{o=r=0}if(n[0]&5)throw n[1];return{value:n[0]?n[1]:void 0,done:true}}};System.register(["./p-f4cc861d.system.js","./p-4b0c1219.system.js"],(function(e){"use strict";var t,i,o,s,r,n;return{setters:[function(e){t=e.r;i=e.c;o=e.d;s=e.h;r=e.g},function(e){n=e.B}],execute:function(){var a={en:{play:"Play"}};var l="full-height-video";var c=e("dxp_video",function(){function e(e){t(this,e);this.autoplay=false;this.customMuteButton=false;this.customMuteButtonPosition="top-right";this.disableControls=false;this.fullHeight=false;this.iconType="light";this.muted=true;this.analyticsDataEmitter=i(this,"dxp_comp",7)}e.prototype.componentWillLoad=function(){this.base=new n(this,o);this.base.i18Init(o,"Video",a);if(this.disableControls){this.autoplay=true}this.srcVideo?this.formVideoSource():o.log.debug(this.element.tagName,"componentWillLoad()","Source id is missing")};e.prototype.componentDidLoad=function(){if(this.autoplay&&this.type==="hostedInternally"||this.type==="hostedExternally"&&this.srcVideo.toLowerCase().indexOf("akamai")>0){if(!this.width){this.videoElementRef.setAttribute("width","100%")}}if(this.autoplay){this.emitAnalyticsData("play")}this.schemaScript();this.lazyLoadVideo()};e.prototype.componentDidUpdate=function(){this.lazyLoadVideo()};e.prototype.keyDownHandler=function(e){if(e.keyCode===13||e.keyCode===32){if(this.iframePoster&&this.iframePoster.style.display!=="none"){this.onPosterClick()}}};e.prototype.pauseVideo=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){e=this.base.shadowRootQuerySelector(this.element,"video");e.pause();return[2]}))}))};e.prototype.playVideo=function(){return __awaiter(this,void 0,void 0,(function(){var e;return __generator(this,(function(t){e=this.base.shadowRootQuerySelector(this.element,"video");e.play();return[2]}))}))};e.prototype.disableVideoControls=function(){var e=this;return this.disableControls&&this.customMuteButton?s("button",{ref:function(t){return e.customMuteRef=t},onClick:function(){e.toggleMute()},class:this.customMuteButtonPosition+" custom-control"},s("i",{class:""+(this.muted?"mute-icon":"unmute-icon")})):""};e.prototype.emitAnalyticsData=function(e){var t={di_comp_name:this.element.tagName,di_comp_title:this.srcVideo,di_comp_videoname:this.videoName,di_comp_videoaction:e};this.analyticsDataEmitter.emit(t);o.log.info(this.element.tagName,"emitAnalyticsData()",t)};e.prototype.fallBack=function(){var e=this.base.shadowRootQuerySelector(this.element,"video",false);var t=this.base.shadowRootQuerySelector(this.element,"img",false);setTimeout((function(){var i=window.pageYOffset;if(e&&e["offsetTop"]<window.innerHeight+i){e["src"]=e["dataset"].src}if(t&&t["offsetTop"]<window.innerHeight+i){t["src"]=t["dataset"].src}}),20)};e.prototype.formVideoSource=function(){if(this.type&&this.type.toLocaleLowerCase()==="youtube"){this.handleYoutube()}else if(this.type&&this.type.toLocaleLowerCase()==="vimeo"){this.handleVimeo()}else if(this.type&&this.type.toLocaleLowerCase()==="youku"){this.handleYouku()}else{this.videoSource=this.autoplay?this.srcVideo+"?autoplay=1":this.srcVideo}};e.prototype.handleAkamai=function(){var e=this;var t=s("div",{ref:function(t){return e.iframePoster=t},onClick:function(){return e.onPosterClick()},tabindex:"0",class:"video-thumbnail","aria-label":o.i18n.t("Video:play"),style:{display:this.autoplay?"none":"block"}},s("img",{"data-src":this.srcPoster,style:{display:!this.srcPoster?"none":"block"}}),s("div",{class:"video-poster"},s("img",{"data-src":"https://asset.mastercard.com/dxp-ui/assets"+"/dxp-video/play-icon-"+this.iconType+".png"})));return s("div",{tabindex:"0",class:this.fullHeight?l:"embed-responsive embed-responsive-16by9"},s("iframe",{ref:function(t){return e.iframeRef=t},style:{display:this.autoplay||!this.srcPoster?"block":"none"},class:this.fullHeight?l:"embed-responsive-item",src:this.autoplay||!this.srcPoster?this.videoSource:"",frameborder:"0",allowFullScreen:true}),t)};e.prototype.handleVimeo=function(){var e="https://player.vimeo.com/video/";this.videoSource=this.is_url(this.srcVideo)?this.srcVideo.slice(this.srcVideo.lastIndexOf("/")+1,this.srcVideo.length):this.srcVideo;this.videoSource=e+this.videoSource;this.videoSource=this.autoplay?this.videoSource+"?autoplay=1":this.videoSource;if(this.disableControls){var t=this.videoSource.split("?")[0];this.videoSource=t+"?autoplay=1&api=1&background=1&loop=1"}};e.prototype.handleYouku=function(){var e;var t="https://player.youku.com/embed/";if(this.is_url(this.srcVideo)){if(this.srcVideo.indexOf("/embed/")===-1){e=this.srcVideo.split("id_");e=e[1].split(".html");this.videoSource=e[0].slice(0);this.videoSource=t+this.videoSource}else{this.videoSource=this.srcVideo}}else{this.videoSource=this.srcVideo;this.videoSource=t+this.videoSource}this.videoSource=this.autoplay?this.videoSource+"?autoplay=1":this.videoSource};e.prototype.handleYoutube=function(){var e;var t;var i="https://www.youtube.com/embed/";if(this.is_url(this.srcVideo)){if(this.srcVideo.indexOf("/embed/")===-1){e=t=this.srcVideo.split("?");e=e[1].split("=")[1];t=t[1].split("&");this.videoSource=t[0].slice(2);this.videoSource=i+this.videoSource}else{this.videoSource=this.srcVideo;var o=this.srcVideo.split("embed/")[1];e=o.split("?")[0]}}else{e=this.srcVideo;this.videoSource=this.srcVideo;this.videoSource=i+this.videoSource}this.videoSource=this.autoplay?this.videoSource+"?autoplay=1":this.videoSource;if(this.disableControls){var s=this.videoSource.split("?")[0];this.videoSource=s+"?autoplay=1&controls=0&showinfo=0&rel=0&version=3&loop=1&playlist="+e}};e.prototype.is_url=function(e){var t=/^(http:\/\/www\.|https:\/\/www\.|http:\/\/|https:\/\/)?[a-z0-9]+([\-\.]{1}[a-z0-9]+)*\.[a-z]{2,5}(:[0-9]{1,5})?(\/.*)?$/;if(t.test(e)){return true}return false};e.prototype.lazyLoadVideo=function(){var e;var t;if(window["IntersectionObserver"]){e=this.base.shadowRootQuerySelector(this.element,"video",false);t=this.base.shadowRootQuerySelector(this.element,"img",false);var i=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){var t=e.target;t["src"]=t["dataset"].src;i.unobserve(t)}}))}));var o=new IntersectionObserver((function(e){e.forEach((function(e){if(e.isIntersecting){var t=e.target;t["src"]=t["dataset"].src;o.unobserve(t)}}))}));if(e){i.observe(e)}if(t){o.observe(t)}}else{this.fallBack()}};e.prototype.onPosterClick=function(){this.iframeRef.setAttribute("src",this.videoSource+"?autoplay=1");this.iframeRef.setAttribute("style","display:block");this.iframePoster.setAttribute("style","display:none");this.emitAnalyticsData("play")};e.prototype.schemaScript=function(){var e={"@context":"http://schema.org","@type":"VideoObject",name:this.videoName,description:this.videoDescription,thumbnailUrl:this.srcPoster,uploadDate:this.videoUploadDate,contentUrl:this.videoSource};var t=JSON.stringify(e);this.base.createSeoSchema(o,this.element,t)};e.prototype.toggleMute=function(){this.muted=!this.muted;this.emitAnalyticsData(this.muted?"mute":"unmute")};e.prototype.render=function(){var e=this;o.log.debug(this.element.tagName,"render()","in dxp-video render() : "+"DEVELOPMENT");var t=function(){if(e.type!=="hostedInternally"&&(e.srcVideo&&e.srcVideo.toLowerCase().indexOf("akamai")===-1)){return e.handleAkamai()}return s("div",{class:e.fullHeight?l:"embed-responsive embed-responsive-16by9"},s("video",{ref:function(t){return e.videoElementRef=t},class:e.fullHeight?l:"embed-responsive-item",poster:e.srcPoster,"data-src":e.videoSource,loop:true,autoplay:e.autoplay,muted:e.muted,controls:!e.disableControls,width:e.width}),e.disableVideoControls())};var i=s("span",null,s("link",{rel:"stylesheet",href:""}),this.theme&&s("link",{rel:"stylesheet",href:""}),this.theme&&s("link",{rel:"stylesheet",href:o.config.get("DXP_STYLE_BASE_URL")+"/themes/"+this.theme+"/dxp-video.min.css"}),this.dtmUrl&&s("script",{src:this.dtmUrl}));return s("div",{class:this.base.componentClass(),"data-theme":this.theme,style:{width:this.width+"px",height:this.fullHeight?"100%":""}},i,t())};Object.defineProperty(e.prototype,"element",{get:function(){return r(this)},enumerable:true,configurable:true});Object.defineProperty(e,"style",{get:function(){return"div.dxp.dxp-video{width:100%}div.dxp.dxp-video .top-left{position:absolute;top:0;left:0}div.dxp.dxp-video .top-right{position:absolute;top:0;right:0}div.dxp.dxp-video .bottom-right{position:absolute;bottom:0;right:0}div.dxp.dxp-video .bottom-left{position:absolute;bottom:0;left:0}div.dxp.dxp-video .custom-control{cursor:pointer;z-index:100;bottom:.9375rem;right:.9375rem;margin:.125rem;border-radius:50%;overflow:hidden;border:none;-webkit-backdrop-filter:blur(1.25rem);backdrop-filter:blur(1.25rem)}div.dxp.dxp-video .custom-control,div.dxp.dxp-video .custom-control i{display:inline-block;height:2.5rem;width:2.5rem}div.dxp.dxp-video .full-height-video{height:100%;width:100%}div.dxp.dxp-video .full-height-video iframe,div.dxp.dxp-video .full-height-video video{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%);height:auto;width:auto;min-height:100%;min-width:100%}div.dxp.dxp-video .embed-responsive{position:relative;padding-bottom:56.25%;height:0}div.dxp.dxp-video .embed-responsive iframe{position:absolute;top:0;left:0;width:100%;height:100%}div.dxp.dxp-video .video-thumbnail{cursor:pointer;position:absolute;text-align:center;top:0;width:100%;height:100%}div.dxp.dxp-video .video-thumbnail img{width:100%;height:100%}div.dxp.dxp-video .video-overlay,div.dxp.dxp-video .video-poster{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}div.dxp.dxp-video .video-overlay{display:block;height:80px;width:80px}\@media (max-width:767.98px){div.dxp.dxp-video .embed-responsive{position:relative;display:block;width:100%!important;padding:0;height:auto!important;overflow:hidden}div.dxp.dxp-video .embed-responsive:before{display:block;content:\"\"}div.dxp.dxp-video .embed-responsive-item,div.dxp.dxp-video iframe,div.dxp.dxp-video video{position:absolute;top:0;bottom:0;left:0;width:100%;height:100%;border:0}div.dxp.dxp-video .embed-responsive-16by9:before{padding-top:56.25%}div.dxp.dxp-video .video-thumbnail{position:absolute;top:0}}"},enumerable:true,configurable:true});return e}())}}}));