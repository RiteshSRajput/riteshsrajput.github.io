import{r as s,c as t,d as e,h as i,g as r}from"./p-8188e849.js";import{B as a}from"./p-16d6f0ca.js";const d={en:{requiredField:"Required field"},es:{requiredField:"Campo requerido"}},n=class{constructor(e){s(this,e),this.isSubmitApi=!1,this.buttonPosition="left",this.buttonType="primary",this.formSubmitted=t(this,"formSubmitted",7)}async componentWillLoad(){this.base=new a(this,e),this.base.i18Init(e,"Form",d),this.formId?await this.getService(e.config.get("FORM_AS_SERVICE_URL")):this.apiUrl?await this.getService(this.apiUrl):this.formJson&&("string"==typeof this.formJson&&(this.formJson=JSON.parse(this.formJson)),this.formSchema=this.formJson.FormSchema&&this.formJson.FormSchema.fields,this.formEvents=this.formJson.FormSchema&&this.formJson.FormSchema.event)}routingHandler(s){this.base.routingEventListener(s)}fieldValidations(s){const t=this.element.querySelector(`#${s.name}`);t.classList.add("dxp-field-error");const e=t.closest(".input-container");e&&(e.previousElementSibling&&e.previousElementSibling.classList.add("dxp-error"),e.nextElementSibling&&e.nextElementSibling.classList.remove("dxp-none"),t.nextElementSibling&&t.nextElementSibling.classList.remove("dxp-none")),"checkbox"===t.getAttribute("type")&&t.nextElementSibling.classList.add("checkbox-error")}formSubmit(s){const t={method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(s)};this.formEvents&&this.formEvents.forEach(s=>{"onSubmit"===s.eventType&&(this.isSubmitApi=!0,s.eventServiceInfo.forEach(async s=>{await e.api(s.serviceUrl,t)}))}),this.isSubmitApi||(e.log.debug(this.element.tagName,"formSubmit()","event emit for SPA"),this.formSubmitted.emit({formData:s}))}formValidations(s){for(const t of s.elements)t.name&&(t.validity.valid||this.fieldValidations(t))}formValidityCheck(s){const t={};for(const e of s.elements)e.name&&(t[e.name]=e.value);t&&this.formSubmit(t)}async getData(s){try{if(this.formId){const t={};t.formId=this.formId;const i={method:"GET",headers:t};return await e.api(s,i)}return await e.api(s)}catch(t){e.log.error(this.element.tagName,"getData()","fetch failed for",t)}}getErrorMessage(s){return i("div",{class:"dxp-none dxp-error"},s.templateOptions.validationMessage)}async getService(s){this.formJson=await this.getData(s),this.formSchema=this.formJson&&this.formJson.FormSchema&&this.formJson.FormSchema.fields,this.formEvents=this.formJson.FormSchema&&this.formJson.FormSchema.event}handleChange(s){if(s.target.value){s.target.classList.remove("dxp-field-error");const t=s.target.closest(".input-container");t&&(t.previousElementSibling&&t.previousElementSibling.classList.remove("dxp-error"),t.nextElementSibling&&t.nextElementSibling.classList.add("dxp-none"),s.target.nextElementSibling&&s.target.nextElementSibling.classList&&s.target.nextElementSibling.classList.add("dxp-none")),"checkbox"===s.target.getAttribute("type")&&s.target.nextElementSibling.classList.remove("checkbox-error")}}preventSubmit(s){return s.preventDefault(),!1}renderChechbox(s){return i("div",{class:`form-checkbox form-checkbox-group ${s.className?s.className:""}`},i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-checkbox.min.css`}),i("p",{class:"caption","aria-required":s.templateOptions.required?"true":"","aria-invalid":"false"},s.templateOptions.label),s.templateOptions.options&&s.templateOptions.options.map(t=>i("div",{class:`${this.theme} dxp-checkbox-group checkbox-item ${s.templateOptions.alignment}`},i("input",{type:"checkbox",id:s.key,name:s.key,required:t.required,onChange:s=>this.handleChange(s),class:"checkbox dxp-field",value:t.value,checked:t.checked,disabled:t.disabled}),i("label",{htmlFor:s.key,class:t.disabled?"dxp-disabled":""},t.required?i("span",{class:"dxp-required"},"* "):"",t.name,"â€Ž"))))}renderFormFields(s){return"input"===s.type&&"textarea"!==s.templateOptions.type?this.renderInput(s):"input"===s.type&&"textarea"===s.templateOptions.type?this.renderTextarea(s):"radio"===s.type?this.renderRadio(s):"checkbox"===s.type?this.renderChechbox(s):"select"===s.type?this.renderSelect(s):void 0}renderInput(s){return i("div",{class:`form-input dxp-mb-2 ${s.className?s.className:""}`},i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-input.min.css`}),i("label",{class:`dxp-inputbox-label ${s.templateOptions.disabled?"dxp-disabled":""}`,htmlFor:s.templateOptions.label},s.templateOptions.label,s.templateOptions.required&&i("span",{class:"dxp-required"},"* ")),i("div",{class:"input-container"},i("input",{class:"",type:s.templateOptions.type,id:s.key,name:s.key,required:s.templateOptions.required,placeholder:s.templateOptions.placeholder,value:s.dafaultValue,minlength:s.templateOptions.minLength,maxlength:s.templateOptions.maxLength,onInput:s=>this.handleChange(s),readonly:s.templateOptions.readonly,disabled:s.templateOptions.disabled,autofocus:s.templateOptions.autoFocus,min:s.templateOptions.min,max:s.templateOptions.max,step:s.templateOptions.step,pattern:s.templateOptions.pattern}),i("span",{class:"dxp-none input-icon icon-sprite error-circle-red"})),this.getErrorMessage(s))}renderRadio(s){return i("div",{class:`form-radio dxp-mb-2 ${s.className?s.className:""}`},i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-radio-button.min.css`}),i("label",{class:"dxp dxp-radio-group-label",htmlFor:s.templateOptions.label},s.templateOptions.required?i("span",{class:"dxp-required"}," ",i("span",{"aria-hidden":"true"},"*")):"",s.templateOptions.label),i("div",{class:"dxp-radio-group-items"},s.templateOptions.options&&s.templateOptions.options.map(t=>i("div",{class:`${this.theme} form-radio-btn dxp-radio-button ${s.templateOptions.alignment}`},i("input",{class:"dxp-field",onChange:s=>this.handleChange(s),id:t.code,type:"radio",key:t.code,name:s.key,value:t.code,checked:t.checked,required:s.templateOptions.required,disabled:s.templateOptions.disabled}),i("label",{htmlFor:t.code},t.name)))),this.getErrorMessage(s))}renderSelect(s){return i("div",{class:`form-select dxp-mb-2 ${s.className?s.className:""}`},i("label",{class:`dxp-inputbox-label ${s.templateOptions.disabled?"dxp-disabled":""}`,htmlFor:s.templateOptions.label},s.templateOptions.label,s.templateOptions.required&&i("span",{class:"dxp-required"},"* ")),i("div",{class:"input-container"},i("select",{class:"dxp-field",onInput:s=>this.handleChange(s),id:s.key,name:s.key,required:s.templateOptions.required},s.templateOptions.options&&s.templateOptions.options.map(s=>i("option",{value:s.code,selected:s.selected,disabled:s.disabled}," ",s.name)))),this.getErrorMessage(s))}renderTextarea(s){return i("div",{class:`form-textarea dxp-mb-2 ${s.className?s.className:""}`},i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-textarea.min.css`}),i("label",{htmlFor:s.templateOptions.label,id:"textarea",class:`dxp-inputbox-label ${s.templateOptions.disabled?"dxp-disabled":""}`},s.templateOptions.label,s.templateOptions.required&&i("span",{class:"dxp-required"},"* ")),i("div",{class:"input-container"},i("textarea",{id:s.key,name:s.key,"aria-labelledby":"textarea",class:`${s.templateOptions.nonResizable?"no-resizable":""} textarea form-control dxp-field`,"aria-invalid":"false","aria-multiline":"true",required:s.templateOptions.required,placeholder:s.templateOptions.placeholder,value:s.defaultValue,onInput:s=>this.handleChange(s),rows:s.templateOptions.rows,cols:s.templateOptions.cols,maxlength:s.templateOptions.maxLength,minlength:s.templateOptions.minLength,"aria-errormessage":"error",disabled:s.templateOptions.disabled,style:{width:`${s.templateOptions.width}px`}})),this.getErrorMessage(s))}submitHandler(){const s=this.element.querySelector("form");s.checkValidity()?this.formValidityCheck(s):this.formValidations(s)}render(){if(e.log.debug(this.element.tagName,"render()","in dxp-form render() : DEVELOPMENT"),!this.apiUrl&&!this.formJson)return void e.log.debug(this.element.tagName,"render()","component not rendered : check API URL or formJson data");const s=[i("link",{rel:"stylesheet",href:"https://asset.mastercard.com/dxp-styles/latest/css/dxp.min.css"}),i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-cta.min.css`}),i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/dxp-form.min.css`}),[this.theme&&i("link",{rel:"stylesheet",href:`https://asset.mastercard.com/dxp-styles/latest/css/themes/${this.theme}/${this.theme}.min.css`})]];return i("div",{class:this.base.componentClass(),dir:this.dir,"data-theme":this.theme},s,this.formJson&&this.formJson.formTitle&&i("h2",null,this.formJson.formTitle),this.formJson&&this.formJson.formSubTitle&&i("p",{class:"dxp-lead"},this.formJson.formSubTitle),i("form",{id:"form",onSubmit:s=>{this.preventSubmit(s)}},this.formSchema&&this.formSchema.map(s=>this.renderFormFields(s)),i("p",{class:"dxp-font-size-sm dxp-mt-6"},`(*${e.i18n.t("TagInput:requiredField")})`),this.formJson&&this.formJson.confirmationMsg&&i("p",{class:"dxp-font-size-sm  dxp-mt-6",innerHTML:this.formJson.confirmationMsg}),i("div",{class:`dxp-btn-form align-${this.buttonPosition}`},i("button",{class:` dxp-btn dxp-btn-${this.buttonType}`,type:"submit",value:this.buttonText,onClick:()=>this.submitHandler()},this.buttonText))))}get element(){return r(this)}static get style(){return"div.dxp.dxp-form .form-input .input-container{position:relative;width:100%}div.dxp.dxp-form .form-input .input-icon{position:absolute;right:.5rem;top:.75rem}div.dxp.dxp-form .form-textarea textarea{padding:.675rem .875rem;resize:auto}div.dxp.dxp-form .form-textarea textarea.no-resizable{resize:none}div.dxp.dxp-form .form-textarea label{display:block}div.dxp.dxp-form .form-radio{margin:16px 0}div.dxp.dxp-form .form-radio .dxp-error,div.dxp.dxp-form .form-radio .dxp-radio-group-label{display:block;margin:0 0 0 10px}div.dxp.dxp-form .form-radio .form-radio-btn{margin:10px 10px 0}div.dxp.dxp-form .form-radio .form-radio-btn.horizontal{display:-ms-inline-flexbox;display:inline-flex}div.dxp.dxp-form .form-radio .form-radio-btn.vertical{display:grid}div.dxp.dxp-form .form-radio .form-radio-btn input[type=radio]{position:absolute;opacity:0;width:0}div.dxp.dxp-form .form-radio .form-radio-btn input[type=radio]+label{padding-left:26px;position:relative;margin:0}div.dxp.dxp-form .form-radio .form-radio-btn input[type=radio]+label:before{content:\"\";width:18px;height:18px;position:absolute;top:50%;left:0;-webkit-transform:translateY(-50%);transform:translateY(-50%)}div.dxp.dxp-form .form-radio .form-radio-btn input[type=radio][disabled]{pointer-events:none}div.dxp.dxp-form .form-radio .form-radio-btn input[type=radio][disabled]+label{cursor:not-allowed}div.dxp.dxp-form .form-checkbox-group input[type=checkbox]{opacity:0;position:absolute}div.dxp.dxp-form .form-checkbox-group .caption{margin-bottom:10px}div.dxp.dxp-form .form-checkbox-group .checkbox-item{position:relative}div.dxp.dxp-form .form-checkbox-group.horizontal .checkbox-item{display:inline-block;margin-right:10px}div.dxp.dxp-form .form-checkbox-group.vertical{display:block}div.dxp.dxp-form .form-checkbox-group.vertical .checkbox-item+.dxp-error{padding-left:26px;margin:0}div.dxp.dxp-form .form-checkbox .checkbox-item{position:relative}div.dxp.dxp-form .form-checkbox .checkbox-item input[type=checkbox]{opacity:0;position:absolute}div.dxp.dxp-form .form-checkbox .checkbox-item input[type=checkbox]+label{padding-left:25px;position:relative}div.dxp.dxp-form .form-checkbox .checkbox-item input[type=checkbox]+label:before{content:\"\";display:inline-block;width:1rem;height:1rem;top:0;position:absolute;left:0;cursor:pointer}div.dxp.dxp-form .form-checkbox .checkbox-item.horizontal{display:inline-block;margin-right:10px}div.dxp.dxp-form .form-checkbox .checkbox-item.vertical input[type=checkbox]+label .dxp-required{display:table-cell}div.dxp.dxp-form .form-checkbox .checkbox-item.vertical .dxp-error{padding-left:2.5rem}div.dxp.dxp-form .dxp-btn-form.align-center{text-align:center}div.dxp.dxp-form .dxp-btn-form.align-right{text-align:right}div.dxp.dxp-form .dxp-btn-form.align-left{text-align:left}"}};export{n as dxp_form};