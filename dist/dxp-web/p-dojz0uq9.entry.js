import{r as t,c as i,d as s,h,g as e}from"./p-8188e849.js";import{B as a}from"./p-16d6f0ca.js";const l=class{constructor(s){t(this,s),this.captionPosition="bottom-left",this.imageTitle="",this.analyticsDataEmitter=i(this,"dxp_comp",7)}imagePathChangeHandler(){this.imgSrc=this.src}componentWillLoad(){this.base=new a(this,s),this.loadResource(),this.calculateFocalPoint()}componentDidLoad(){this.imageContainer=this.element.querySelector(".image-container"),this.anchorElm=this.element.querySelector(".image-container a"),this.imgParentElm=this.anchorElm?this.anchorElm:this.imageContainer,this.componentParentElm=this.element.parentElement,this.img=this.element.querySelector("img"),this.lazyLoadImage(),this.applyFocalPoints()}componentWillUpdate(){if(this.responsive)return this.img.removeAttribute("style"),void this.imgParentElm.removeAttribute("style")}componentDidUpdate(){this.lazyLoadImage()}routingHandler(t){this.base.routingEventListener(t)}windowResizes(){clearTimeout(this.timeOut),this.timeOut=setTimeout(()=>{this.loadResource()},300)}applyFocalPoints(){const t=this.dir.toLowerCase();this.focalPoints&&void 0!==this.xPos&&void 0!==this.yPos&&!this.responsive&&(this.img.style.left="rtl"!==t?`${this.xPos}%`:`-${this.xPos}%`,"auto"===window.getComputedStyle(this.componentParentElm).height?this.img.style.transform="rtl"!==t?`translate(-${this.xPos}%, 0)`:`translate(${this.xPos}%, 0%)`:(this.img.style.transform="rtl"!==t?`translate(-${this.xPos}%, -${this.yPos}%)`:`translate(${this.xPos}%, -${this.yPos}%)`,this.img.style.top=`${this.yPos}%`))}calculateDeviceFocalPoint(t,i,s){this.focalPoints=t||i||s||""}calculateFocalPoint(){if(void 0!==this.focalPoints)try{this.focalPoints="string"==typeof this.focalPoints&&0!==this.focalPoints.length?JSON.parse(this.focalPoints):this.focalPoints,2===this.focalPoints.length&&this.focalPoints[0]<=10&&this.focalPoints[1]<=10?(this.xPos="rtl"!==this.dir?10*this.focalPoints[0]:10*(10-this.focalPoints[0]),this.yPos=10*this.focalPoints[1]):this.focalPoints=void 0}catch(t){return this.focalPoints=void 0,s.log.error(this.element.tagName,"calculateFocalPoint()","Error message: ",t),!1}}emitAnalyticsData(){const t={di_comp_name:this.element.tagName,di_comp_title:this.imageTitle,di_comp_src:this.imgSrc};this.analyticsDataEmitter.emit(t),s.log.info(this.element.tagName,"emitAnalytics()",t)}fallBack(){const t=this.base.shadowRootQuerySelector(this.element,"img",!1);setTimeout(()=>{const i=window.pageYOffset;t.offsetTop<window.innerHeight+i&&(t.src=t.dataset.src,t.classList.remove("lazy"))},20)}lazyLoadImage(){let t;if(window.IntersectionObserver){t=this.base.shadowRootQuerySelector(this.element,"img",!1);const i=new IntersectionObserver(t=>{t.forEach(t=>{if(t.isIntersecting){const s=t.target;s.src=s.dataset.src,s.classList.remove("lazy"),i.unobserve(s)}})});t&&i.observe(t)}else this.fallBack()}loadResource(){"xl"===this.base.getDeviceWidthType()||"lg"===this.base.getDeviceWidthType()?(this.imgSrc=this.src?this.src:"",this.calculateDeviceFocalPoint("","",this.focalPoint)):"md"===this.base.getDeviceWidthType()?(this.imgSrc=this.srcLg?this.srcLg:this.src?this.src:"",this.calculateDeviceFocalPoint("",this.focalPointLg,this.focalPoint)):(this.imgSrc=this.srcMd?this.srcMd:this.srcLg?this.srcLg:this.src?this.src:"",this.calculateDeviceFocalPoint(this.focalPointMd,this.focalPointLg,this.focalPoint)),this.calculateFocalPoint(),setTimeout(()=>{this.focalPoints&&!this.responsive&&this.applyFocalPoints()},300)}renderCaptions(){return(this.captionTitle||this.captionEyebrow||this.captionSubtitle)&&h("div",{class:this.captionPosition},this.captionEyebrow&&h("p",{class:"dxp-title-eyebrow dxp-font-size-lg"},this.captionEyebrow),this.captionTitle&&h("h3",{class:"dxp-title-1"},this.captionTitle),h("p",{class:this.captionSubtitle?"description dxp-hidden-xs-only":"description"},this.captionSubtitle))}render(){return this.imgSrc&&this.imgSrc.length?h("div",{class:this.base.componentClass(),dir:this.dir},h("link",{rel:"stylesheet",href:""}),this.theme&&[h("link",{rel:"stylesheet",href:""}),h("link",{rel:"stylesheet",href:`${s.config.get("DXP_STYLE_BASE_URL")}/themes/${this.theme}/dxp-image.min.css`})],this.dtmUrl&&h("script",{src:this.dtmUrl}),h("div",{class:"image-container"},this.href?h("a",{href:this.href,"aria-label":this.ariaLabel,target:this.openInNewTab?"_blank":"_self",onClick:()=>this.emitAnalyticsData()},h("img",{class:this.focalPoints&&!this.responsive?"focal-point-img":this.responsive?"dxp-img-fluid":void 0,alt:this.alt,title:this.imageTitle,"data-src":this.imgSrc}),this.enableOverlay&&h("div",{class:"overlay"},h("p",null,this.imageTitle,h("slot",{name:"overlay"})))):[h("img",{class:this.focalPoints&&!this.responsive?"focal-point-img":this.responsive?"dxp-img-fluid":void 0,alt:this.alt,title:this.imageTitle,"data-src":this.imgSrc}),this.enableOverlay&&h("div",{class:"overlay"},h("p",null,this.imageTitle,h("slot",{name:"overlay"})))],this.renderCaptions())):void 0}get element(){return e(this)}static get watchers(){return{src:["imagePathChangeHandler"]}}static get style(){return"div.dxp.dxp-image .image-container{position:relative;overflow:hidden;width:100%}div.dxp.dxp-image .focal-point-img{width:auto;max-height:100%;position:relative}div.dxp.dxp-image .image-container a{display:block;position:relative}div.dxp.dxp-image .image-container .overlay{position:absolute;top:0;bottom:0;left:0;right:0;display:none;font-size:30px;text-align:center}div.dxp.dxp-image .image-container .overlay p{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}div.dxp.dxp-image .image-container:hover .overlay{display:block;cursor:pointer}div.dxp.dxp-image .bottom-left{position:absolute;bottom:32px;left:24px}div.dxp.dxp-image .top-left{position:absolute;top:32px;left:24px}div.dxp.dxp-image .top-right{position:absolute;top:32px;right:24px}div.dxp.dxp-image .bottom-right{position:absolute;bottom:32px;right:24px}div.dxp.dxp-image .centered{position:absolute;top:50%;left:50%;-webkit-transform:translate(-50%,-50%);transform:translate(-50%,-50%)}\@media (min-width:992px){div.dxp.dxp-image .full-width-lg{min-width:100%;min-height:100%}div.dxp.dxp-image .focal-point-img{max-height:none}}\@media (max-width:991px){div.dxp.dxp-image .focal-point-img{min-height:100%}div.dxp.dxp-image .full-width-md-down{min-width:100%;max-height:none}}"}};export{l as dxp_image};